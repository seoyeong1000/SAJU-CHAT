# ğŸ“‚ [Final] Seed Data ETL Mapping Specification (v1.0)
- ëª©ì : ì—…ë¡œë“œëœ Raw Data(CSV/TXT)ë¥¼ ì„œë¹„ìŠ¤ DBì— **ì•ˆì „í•˜ê²Œ ì ì¬(Seed)**í•˜ê¸° ìœ„í•œ â€œíŒŒì‹±/ë§¤í•‘ ê·œê²©(ë ˆì‹œí”¼)â€
- ëŒ€ìƒ: `seed.ts`(ë˜ëŠ” `scripts/seed.ts`)ë¥¼ êµ¬í˜„í•˜ëŠ” ê°œë°œì/ì—ì´ì „íŠ¸
- í•µì‹¬ ì›ì¹™: **ê³ ë¯¼ ì—†ì´ ì´ ë¬¸ì„œëŒ€ë¡œë§Œ íŒŒì‹±í•˜ë©´ DBê°€ ì—‰í‚¤ì§€ ì•Šê²Œ ë§Œë“ ë‹¤.**

---

## 0) ì´ˆë³´ì ë²„ì „ ì„¤ëª… (ì´ì‚¬ì§ ì„¼í„° ì§€ì‹œì„œ)
- CSV/TXT íŒŒì¼ = ì´ì‚¿ì§ ë°•ìŠ¤
- DB í…Œì´ë¸” = ìƒˆì§‘ì˜ ë°©/ê°€êµ¬
- ì´ ë¬¸ì„œ = â€œë°•ìŠ¤ AëŠ” ê±°ì‹¤ ì±…ì¥ 1ì¹¸, ë°•ìŠ¤ BëŠ” ì£¼ë°© ì„œë 3ì¹¸â€ ê°™ì€ **ì •ë¦¬ ê·œì¹™**

> ê²°ë¡ : ê°œë°œìëŠ” â€œì–´ë””ì— ë¬´ì—‡ì„ ë„£ì„ì§€â€ ê³ ë¯¼í•˜ì§€ ë§ê³ , **íŒŒì‹± ì½”ë“œë§Œ** ì§œë©´ ë©ë‹ˆë‹¤.

---

## 1) Target Schema (Seed ì ì¬ìš© ìµœì†Œ í…Œì´ë¸”)
> âš ï¸ ì§€ê¸ˆ Phaseì—ì„œëŠ” â€œì™„ë²½í•œ ì˜ë¯¸ ë¶„ë¥˜â€ë³´ë‹¤ **ì•ˆì „í•œ ì ì¬ + ì¶œì²˜ ì¶”ì **ì´ ìš°ì„ ì…ë‹ˆë‹¤.  
> ë”°ë¼ì„œ 1ì°¨ ì ì¬ëŠ” ì•„ë˜ ë‘ í…Œì´ë¸”ë¡œ **ì›ë³¸ì„ ì•ˆì „í•˜ê²Œ ë³´ê´€**í•˜ê³ ,  
> ê·¸ ë‹¤ìŒ ë‹¨ê³„(2ì°¨ ETL/LLM ìƒì„±)ì—ì„œ `INTERPRETATION_BASE` ê°™ì€ â€œì •ì œ DBâ€ë¥¼ ë§Œë“­ë‹ˆë‹¤.

### 1.1 `seed_documents` (ë¬¸ì„œ ë‹¨ìœ„ ë³´ê´€: TXT/CSV ì›ë¬¸ ì¶œì²˜)
- ì—­í• : â€œì–´ëŠ íŒŒì¼ì˜ ì–´ëŠ ë¬¸ì„œì—ì„œ ì™”ëŠ”ì§€â€ ì¶”ì  ê°€ëŠ¥í•œ ì›ë¬¸ ë³´ê´€ì†Œ

```sql
CREATE TABLE seed_documents (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  source_file TEXT NOT NULL,        -- ì˜ˆ: '@1_8_í†µí•©ìë£Œ.txt'
  source_doc_title TEXT,            -- ì˜ˆ: '1_í™©ì œë‚´ê²½.txt' (BEGIN/markerì—ì„œ ì¶”ì¶œ)
  source_doc_index INT NOT NULL,    -- íŒŒì¼ ë‚´ë¶€ ë¬¸ì„œ ìˆœì„œ(0..)
  raw_text TEXT NOT NULL,           -- ë¬¸ì„œ ì „ì²´ ì›ë¬¸(ë˜ëŠ” í° ê²½ìš° chunkë¡œ ìª¼ê°œë„ ë¨)
  metadata JSONB DEFAULT '{}'::jsonb,
  created_at TIMESTAMPTZ DEFAULT now()
);
```

### 1.2 `saju_contents` (ê²€ìƒ‰/í™œìš© ë‹¨ìœ„: â€œì„¹ì…˜/ì²­í¬â€)
- ì—­í• : ì•±/RAG/ë¦¬í¬íŠ¸ ìƒì„±ì´ ê°€ì ¸ë‹¤ ì“°ê¸° ì¢‹ì€ ë‹¨ìœ„ë¡œ ì˜ë¼ ì €ì¥

```sql
CREATE TABLE saju_contents (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  category TEXT NOT NULL,            -- ë‚´ë¶€ ì¹´í…Œê³ ë¦¬(ì•„ë˜ ê·œì¹™)
  logic_key TEXT NOT NULL,           -- ì•ˆì •ì ì¸ í‚¤(ì•„ë˜ ê·œì¹™)
  title TEXT,                        -- ì‚¬ìš©ìì—ê²Œ ë³´ì¼ ì œëª©(ì„¹ì…˜ íƒ€ì´í‹€)
  content_template TEXT NOT NULL,    -- ë³¸ë¬¸(ì¤„ë°”ê¿ˆ ìœ ì§€)
  source_file TEXT NOT NULL,         -- ì¶œì²˜ íŒŒì¼ëª…
  source_ref JSONB DEFAULT '{}'::jsonb, -- doc_title, heading_path, index ë“±
  metadata JSONB DEFAULT '{}'::jsonb,   -- tags, level, date, link ë“±
  created_at TIMESTAMPTZ DEFAULT now()
);

-- ë©±ë“±(ì¤‘ë³µ ë°©ì§€) í•µì‹¬ ìœ ë‹ˆí¬ í‚¤(ê°•ì œ)
CREATE UNIQUE INDEX IF NOT EXISTS uq_saju_contents_key
  ON saju_contents(category, logic_key);
```

> âœ… ì™œ 2í…Œì´ë¸”ì¸ê°€?
- `seed_documents`: â€œì›ë³¸ í†µì§¸ë¡œâ€ ë³´ê´€(ë‚˜ì¤‘ì— ì˜¤ë¥˜/ì¶œì²˜ ì¶”ì  ê°€ëŠ¥)
- `saju_contents`: â€œì‹¤ì œë¡œ ì“°ê¸° ì¢‹ê²Œâ€ ì¡°ê°ë‚¸ ì¡°ë¦¬ëœ ì¬ë£Œ

---

## 2) Source Inventory (ì´ë²ˆ í”„ë¡œì íŠ¸ì— ì‹¤ì œë¡œ ìˆëŠ” íŒŒì¼ ëª©ë¡)
| íŒŒì¼ | íƒ€ì… | ê·œëª¨ | ì»¬ëŸ¼/íŠ¹ì§• |
|---|---:|---:|---|
| `@ì‚¼ì†¡ì‚¬ì£¼_í†µí•©_ì •ë¦¬ë³¸.csv` | CSV | 472 rows | id, category, title, link, date_iso, content, source_file<br/>top category: {'ê¸°ì´ˆ': 331, 'ì¤‘ê¸‰': 81, '60ê°‘ì': 60} |
| `@ì–´ë°”ì›ƒì‚¬ì£¼.csv` | CSV | 31 rows | id, content, source_file<br/> |
| `@í•´ë°_í´ë¦°_ì˜¤í”„ë‹ì œê±°_í†µí•©.csv` | CSV | 1,442 rows | id, title, url, date_iso, category, content, source_file<br/>top category: {'í•´ë°ì˜ ëª…ë¦¬ ê³µë¶€': 1067, 'íˆ¬ì ë‹¨ìƒ(æ–·æƒ³)': 112, 'ê¸ˆìœµ, ì¢…ëª©, ì‚°ì—…ë¶„ì„': 60} |
| `@í˜„ë¬˜_í†µí•©_í´ë¦°_ì˜¤í”„ë‹ì œê±°.csv` | CSV | 1,000 rows | id, source_file, title, detail_title, link, date_iso, content<br/> |
| `@1_8_í†µí•©ìë£Œ.txt` | TXT | 0.09 MB | doc markers: 8 |
| `@ê³ ì „í†µí•©_ì›ë¬¸_ëª…ë¦¬5ì¢…+ëª…ë¦¬ì •ì¢….txt` | TXT | 0.19 MB | doc markers: 6 |
| `@ì„ ìš´_ìë£Œ2ê°œ_í†µí•©ì›ë¬¸.txt` | TXT | 0.45 MB | doc markers: 2 |
| `@ë„í™”ë„ë¥´_ì›ë¬¸_ì¤‘ë³µì œê±°_í†µí•©ì›ë³¸.txt` | TXT | 3.46 MB | markers ì—†ìŒ(ê·œì¹™/ê¸¸ì´ ê¸°ë°˜ ë¶„í•  í•„ìš”) |
| `@ëª…ë¦¬í•™ (ê¸°íƒ€ì‚¬ì£¼ ê°•ì˜ ëª¨ìŒ).txt` | TXT | 0.62 MB | markers ì—†ìŒ(ê·œì¹™/ê¸¸ì´ ê¸°ë°˜ ë¶„í•  í•„ìš”) |
| `@ìµ¸ì½”ì„œë‹¹ ì´ˆëª… ìœ íŠœë¸Œ ì •ë¦¬.txt` | TXT | 1.83 MB | markers ì—†ìŒ(ê·œì¹™/ê¸¸ì´ ê¸°ë°˜ ë¶„í•  í•„ìš”) |

---

## 3) ê³µí†µ ê·œì¹™ (ëª¨ë“  íŒŒì¼ì— ì ìš©ë˜ëŠ” ê¸°ë³¸ ê·œì¹™)
### 3.1 ë©±ë“±ì„±(Idempotency) â€” ë¬´ì¡°ê±´
- seedë¥¼ 10ë²ˆ ì‹¤í–‰í•´ë„ ë°ì´í„°ê°€ **ì¤‘ë³µ ì ì¬ë˜ë©´ ì‹¤íŒ¨**
- ê°•ì œ ê·œì¹™:
  - `saju_contents`: `(category, logic_key)` ìœ ë‹ˆí¬ + UPSERT
  - `seed_documents`: `(source_file, source_doc_index)` ìœ ë‹ˆí¬(ê¶Œì¥)

### 3.2 ì¤„ë°”ê¿ˆ/ë”°ì˜´í‘œ ë³´ì¡´
- `content_template`ëŠ” ì¤„ë°”ê¿ˆ(\n)ì„ **ê·¸ëŒ€ë¡œ ìœ ì§€**
- CSV ë‚´ë¶€ ë”°ì˜´í‘œ/ì‰¼í‘œê°€ ê¹¨ì§€ì§€ ì•Šë„ë¡:
  - íŒŒì„œ: `papaparse` ë˜ëŠ” `csv-parse` ê¶Œì¥(í˜¹ì€ pandasë¡œ ì‚¬ì „ ì ê²€)

### 3.3 ìµœì†Œ í’ˆì§ˆ ê²€ì¦(Validation)
- ì•„ë˜ ì¡°ê±´ì´ë©´ **SKIP + ë¡œê·¸**:
  - contentê°€ ë¹„ì–´ìˆìŒ / 10ì ë¯¸ë§Œ
  - id/logic_keyê°€ ë¹„ì–´ìˆìŒ
- ì ì¬ í›„ â€œí•„ìˆ˜ ë ˆì½”ë“œ ìˆ˜â€ ìµœì†Œì¹˜ í™•ì¸:
  - ì˜ˆ: ì´ ì ì¬ Nê°œ ì´ìƒ, íŒŒì¼ë³„ ìµœì†Œ Mê°œ ì´ìƒ

---

## 4) Category/Logic Key ê·œê²© (ì¤‘ìš”)
### 4.1 category ë‚´ë¶€ í‘œì¤€(í˜„ì‹¤ì ì¸ ìµœì†Œ ì„¸íŠ¸)
> Phase 1 seedì˜ ëª©í‘œëŠ” â€œì •êµí•œ ë¶„ë¥˜â€ê°€ ì•„ë‹ˆë¼ **ì•ˆì „í•œ ë¶„ë¥˜**ì…ë‹ˆë‹¤.

- `general` : ì¼ë°˜ ëª…ë¦¬/í†µë³€/ê¸°ì´ˆ
- `ganji` : ì²œê°„/ì§€ì§€/60ê°‘ì/ì¼ì£¼
- `ten_gods` : ì‹­ì„±/ì‹­ì‹ 
- `five_elements` : ì˜¤í–‰(ëª©í™”í† ê¸ˆìˆ˜)
- `twelve_growth` : ì‹­ì´ìš´ì„±
- `year_fortune` : ì—°ìš´/ì„¸ìš´(ì˜ˆ: 2026ë…„ ìš´ì„¸â€¦)
- `investment` : íˆ¬ì/ê¸ˆìœµ ê´€ë ¨
- `health` : í™©ì œë‚´ê²½/ì˜¤í–‰ ê±´ê°•
- `rag_source` : ê·œì¹™ì  ë§¤í•‘ì´ ì–´ë ¤ìš´ â€œìë£Œì°½ê³ â€(í–¥í›„ ì„ë² ë”©/RAGìš©)

### 4.2 logic_key ìƒì„± ê·œì¹™(ìš°ì„ ìˆœìœ„ ê³ ì •)
- **ìš°ì„ ìˆœìœ„ 1 (CSV)**: `id` ì»¬ëŸ¼ì´ ìˆìœ¼ë©´ **logic_key = id**
- **ìš°ì„ ìˆœìœ„ 2 (TXT ì„¹ì…˜)**:  
  `logic_key = sha1(source_file + '|' + source_doc_title + '|' + heading_path + '|' + section_index).slice(0,16)`
  - ì´ìœ : ì œëª©/ë„ì–´ì“°ê¸° ë°”ë€Œì–´ë„ í‚¤ê°€ ì•ˆì •ì ì´ì–´ì•¼ í•¨
- **ì ˆëŒ€ ê¸ˆì§€**: titleì„ ê·¸ëŒ€ë¡œ logic_keyë¡œ ì“°ê¸°(ë³€ê²½/ì¤‘ë³µ ìœ„í—˜)

---

## 5) íŒŒì¼ë³„ ë§¤í•‘ ê·œì¹™ (Source â†’ Target)

## 5A) Type A: ì •í˜• ë°ì´í„° (CSV)
### A-1) `@ì‚¼ì†¡ì‚¬ì£¼_í†µí•©_ì •ë¦¬ë³¸.csv`
- ì…ë ¥ ì»¬ëŸ¼: `id, category, title, link, date_iso, content, source_file`
- ì ì¬:
  - `saju_contents.category` = CSVì˜ `category`ë¥¼ ê·¸ëŒ€ë¡œ ì €ì¥í•˜ë˜,
    - ë‚´ë¶€ í‘œì¤€ categoryë¡œ ë°”ê¾¸ê³  ì‹¶ìœ¼ë©´ `metadata.source_category`ì— ì›ë³¸ ì €ì¥ + `category_map` ì ìš©(ì„ íƒ)
  - `logic_key` = `id`
  - `title` = `title`
  - `content_template` = `content`
  - `metadata.link` = `link`, `metadata.date_iso` = `date_iso`

### A-2) `@í•´ë°_í´ë¦°_ì˜¤í”„ë‹ì œê±°_í†µí•©.csv`
- ì…ë ¥ ì»¬ëŸ¼: `id, title, url, date_iso, category, content, source_file`
- ì ì¬:
  - `logic_key` = `id`
  - `metadata.link` = `url`
  - ë‚˜ë¨¸ì§€ëŠ” A-1ê³¼ ë™ì¼

### A-3) `@í˜„ë¬˜_í†µí•©_í´ë¦°_ì˜¤í”„ë‹ì œê±°.csv`
- ì…ë ¥ ì»¬ëŸ¼: `id, source_file, title, detail_title, link, date_iso, content`
- ì ì¬:
  - `logic_key` = `id`
  - `title` = `detail_title`ê°€ ìˆìœ¼ë©´ ê·¸ê±¸ ìš°ì„ , ì—†ìœ¼ë©´ `title`
  - `category`ëŠ” ì»¬ëŸ¼ì´ ì—†ìœ¼ë¯€ë¡œ ì•„ë˜ ê·œì¹™ìœ¼ë¡œ ìë™ ë¶€ì—¬:
    - titleì— `ë…„`, `ìš´ì„¸`, `202`(ì—°ë„) í¬í•¨ â†’ `year_fortune`
    - ê·¸ ì™¸ â†’ `general`

### A-4) `@ì–´ë°”ì›ƒì‚¬ì£¼.csv`
- ì…ë ¥ ì»¬ëŸ¼: `id, content, source_file`
- ì ì¬:
  - `logic_key` = `id`
  - `title`ì€ ì—†ìœ¼ë¯€ë¡œ ìë™ ìƒì„±:
    - contentì˜ ì²« ì¤„ì´ 3~60ìë©´ ê·¸ê±¸ titleë¡œ ì‚¬ìš©
    - ì•„ë‹ˆë©´ `AboutSaju_<built-in function id>`
  - `category` ê¸°ë³¸ê°’: `general`

---

## 5B) Type B: ë°˜ì •í˜• í…ìŠ¤íŠ¸ (TXT) â€” â€œë¬¸ì„œ/ì„¹ì…˜ ë¶„ë¦¬â€ê°€ í•µì‹¬
> TXTëŠ” â€œí—¤ë” ê¸°ì¤€ ë¶„ë¦¬â€ê°€ ì˜ ë˜ë©´ ê³ ê¸‰ ìë£Œê°€ ë˜ê³ ,  
> ë¶„ë¦¬ê°€ ì•ˆ ë˜ë©´ RAGìš© ì°½ê³ (`rag_source`)ë¡œ ë„£ëŠ” ê²Œ ì•ˆì „í•©ë‹ˆë‹¤.

### B-ê³µí†µ 1) ë¬¸ì„œ(doc) ë¶„ë¦¬ ê·œì¹™(ìš°ì„ ìˆœìœ„)
1) `===== BEGIN ... =====` ë¼ì¸ì´ ìˆìœ¼ë©´: ê·¸ ë¼ì¸ë§ˆë‹¤ **ìƒˆ ë¬¸ì„œ ì‹œì‘**
   - `source_doc_title` = BEGIN ë¼ì¸ ì•ˆì˜ íŒŒì¼ëª…
2) `BEGIN FILE:` ë¼ì¸ì´ ìˆìœ¼ë©´: ê·¸ ë¼ì¸ë§ˆë‹¤ **ìƒˆ ë¬¸ì„œ ì‹œì‘**
   - `source_doc_title` = ë’¤ì˜ íŒŒì¼ëª…
3) ë‘˜ ë‹¤ ì—†ìœ¼ë©´: íŒŒì¼ ì „ì²´ë¥¼ **ë¬¸ì„œ 1ê°œ**ë¡œ ì·¨ê¸‰

### B-ê³µí†µ 2) ì„¹ì…˜(section) ë¶„ë¦¬ ê·œì¹™(ìš°ì„ ìˆœìœ„)
1) Markdown í—¤ë”: `^#(1, 6)\s+`
2) ë¡œë§ˆìˆ«ì í—¤ë”: `^(I|II|III|IV|V|VI|VII|VIII|IX|X)\.\s+`
3) ìˆ«ì/ì„œë¸Œìˆ«ì: `^\d+(\.\d+)*\.\s+`
4) ìœ„ê°€ ì „í˜€ ì—†ìœ¼ë©´: **ê¸¸ì´ ê¸°ë°˜ ì²­í¬**
   - ëª©í‘œ ê¸¸ì´: 800~1,200ì
   - ë¶„í•  ê¸°ì¤€: ë¹ˆ ì¤„(\n\n) ìš°ì„ , ì—†ìœ¼ë©´ ë¬¸ì¥ ë§ˆì¹¨í‘œ ê¸°ì¤€

### B-ê³µí†µ 3) title(ì„¹ì…˜ ì œëª©) ì¶”ì¶œ
- í—¤ë” ì¤„ ìì²´ë¥¼ titleë¡œ ì‚¬ìš©í•˜ë˜, ê¾¸ë°ˆ ì œê±°:
  - `#`, `##`, `###`, `**` ì œê±°
  - ì•ì˜ ë²ˆí˜¸(ì˜ˆ: `1.1.`) ì œê±°(ì„ íƒ)
- í—¤ë”ê°€ ì—†ê³  ê¸¸ì´ ì²­í¬ë©´:
  - ì²­í¬ ì²« ë¬¸ì¥ 40ì ì´ë‚´ë¥¼ titleë¡œ(ì—†ìœ¼ë©´ `Chunk 0`)

### B-ê³µí†µ 4) category ìë™ ë¶„ë¥˜(í‚¤ì›Œë“œ ê¸°ë°˜, ìµœì†Œ ì•ˆì „ ë²„ì „)
> ì—¬ëŸ¬ í‚¤ì›Œë“œê°€ ë™ì‹œì— ë‚˜ì˜¤ë©´ â€œìš°ì„ ìˆœìœ„â€ë¡œ 1ê°œë§Œ ì„ íƒ(ìºì‹œ/ê²€ìƒ‰ ê¼¬ì„ ë°©ì§€)

ìš°ì„ ìˆœìœ„(ìƒìœ„ê°€ ì´ê¹€):
1. `investment` : íˆ¬ì, ê¸ˆìœµ, ì¢…ëª©, ë§¤ë§¤
2. `health` : í™©ì œë‚´ê²½, ì¥ë¶€, ê²½ë½, ê±´ê°•, ì‹ì´, ì²˜ë°©
3. `twelve_growth` : ì‹­ì´ìš´ì„±
4. `ten_gods` : ì‹­ì„±, ì‹­ì‹ 
5. `five_elements` : ì˜¤í–‰, ëª©(æœ¨), í™”(ç«), í† (åœŸ), ê¸ˆ(é‡‘), ìˆ˜(æ°´)
6. `ganji` : ì²œê°„, ì§€ì§€, 60ê°‘ì, ì¼ì£¼, ê°„ì§€
7. `general` : ê·¸ ì™¸
8. (ë¶„ë¥˜ ìì‹  ì—†ìœ¼ë©´) `rag_source`

---

## 5C) Type C: ë¹„ì •í˜•/ëŒ€ìš©ëŸ‰ TXT â€” â€œRAG ì°½ê³ â€ë¡œ ì•ˆì „ ì ì¬
ì ìš© í›„ë³´:
- `@ì„ ìš´_ìë£Œ2ê°œ_í†µí•©ì›ë¬¸.txt`
- `@ë„í™”ë„ë¥´_ì›ë¬¸_ì¤‘ë³µì œê±°_í†µí•©ì›ë³¸.txt`
- `@ëª…ë¦¬í•™ (ê¸°íƒ€ì‚¬ì£¼ ê°•ì˜ ëª¨ìŒ).txt`
- `@ìµ¸ì½”ì„œë‹¹ ì´ˆëª… ìœ íŠœë¸Œ ì •ë¦¬.txt`

ê¶Œì¥ ì „ëµ:
- ë¬¸ì„œ/ì„¹ì…˜ ë¶„ë¦¬ê°€ 70% ì´ìƒ ì„±ê³µí•˜ë©´ â†’ `general/ganji/...`ë¡œ ë¶„ë¥˜í•´ì„œ `saju_contents` ì ì¬
- ì•„ë‹ˆë©´:
  - `category = rag_source`
  - `metadata.tags`ì— íŒŒì¼ëª… ê¸°ë°˜ íƒœê·¸ë§Œ ë„£ê³ ,
  - ë‚˜ì¤‘ì— ì„ë² ë”© ë‹¨ê³„ì—ì„œ ì‚¬ìš©

---

## 6) seed.ts êµ¬í˜„ ìš”êµ¬ì‚¬í•­ (ê°œë°œìê°€ ê·¸ëŒ€ë¡œ ë”°ë¼ì•¼ í•¨)
### 6.1 ì‹¤í–‰ ì»¤ë§¨ë“œ(ê³ ì •)
- `npm run seed`

### 6.2 ì²˜ë¦¬ ìˆœì„œ(ê³ ì •)
1) CSV ì ì¬ â†’ `saju_contents` UPSERT
2) TXT ë¬¸ì„œ ë¶„ë¦¬ â†’ `seed_documents` INSERT/UPSERT
3) TXT ì„¹ì…˜ ë¶„ë¦¬/ì²­í¬ â†’ `saju_contents` UPSERT
4) ê²€ì¦(ë ˆì½”ë“œ ìˆ˜/í•„ìˆ˜ í‚¤ ì¡´ì¬) â†’ ì‹¤íŒ¨ ì‹œ exit 1

### 6.3 ë¡œê¹…(í•„ìˆ˜)
- íŒŒì¼ë³„:
  - ì½ì€ ë ˆì½”ë“œ ìˆ˜ / ì ì¬ ì„±ê³µ ìˆ˜ / ìŠ¤í‚µ ìˆ˜ / ì—ëŸ¬ ìˆ˜
- ìŠ¤í‚µ ì‚¬ìœ :
  - empty content / invalid encoding / parse fail ë“±

---

## 7) ê°œë°œìì—ê²Œ ì „ë‹¬í•  â€œìµœì¢… ì§€ì‹œ ë¬¸êµ¬â€(ë³µë¶™)
> ì œê³µëœ CSV/TXT íŒŒì¼ì„ DBì— seedë¡œ ì ì¬í•´ì•¼ í•©ë‹ˆë‹¤.  
> ì´ ë¬¸ì„œ(Seed Data ETL Mapping Spec)ì˜ ê·œì¹™ëŒ€ë¡œ íŒŒì‹±/ë§¤í•‘í•˜ê³ , `npm run seed`ë¡œ ì‹¤í–‰ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ì–´ ì£¼ì„¸ìš”.  
> íŠ¹íˆ TXTëŠ” `BEGIN/===== BEGIN` ë¬¸ì„œ ë¶„ë¦¬ â†’ í—¤ë” ê¸°ì¤€ ì„¹ì…˜ ë¶„ë¦¬ â†’ ì—†ìœ¼ë©´ ê¸¸ì´ ê¸°ì¤€ ì²­í¬ë¡œ ì ì¬í•˜ì„¸ìš”.  
> ì ì¬ëŠ” ë°˜ë“œì‹œ ë©±ë“±(Upsert)ì´ì–´ì•¼ í•˜ê³ , `(category, logic_key)` ìœ ë‹ˆí¬ë¥¼ ì§€ì¼œì•¼ í•©ë‹ˆë‹¤.

---

## ë¶€ë¡ A) ì¶”ì²œ: ì½”ë“œì— ë°•ì•„ë‘˜ ê·œì¹™ JSON (seed_mapping_rules_v1.json)
- ì¥ì : ê°œë°œìê°€ ê·œì¹™ì„ ì½”ë“œì— í•˜ë“œì½”ë”©í•˜ë‹¤ê°€ ë§ê°€ëœ¨ë¦¬ëŠ” ê±¸ ë°©ì§€

```json
{
  "category_priority": [
    "investment",
    "health",
    "twelve_growth",
    "ten_gods",
    "five_elements",
    "ganji",
    "general",
    "rag_source"
  ],
  "keywords": {
    "investment": [
      "íˆ¬ì",
      "ê¸ˆìœµ",
      "ì¢…ëª©",
      "ë§¤ë§¤",
      "ì°¨íŠ¸",
      "ë¦¬ìŠ¤í¬"
    ],
    "health": [
      "í™©ì œë‚´ê²½",
      "ì¥ë¶€",
      "ê²½ë½",
      "ê±´ê°•",
      "ì‹ì´",
      "ì²˜ë°©",
      "ì¹˜ë£Œ"
    ],
    "twelve_growth": [
      "ì‹­ì´ìš´ì„±",
      "ì¥ìƒ",
      "ëª©ìš•",
      "ê´€ëŒ€",
      "ê±´ë¡",
      "ì œì™•",
      "ì‡ ",
      "ë³‘",
      "ì‚¬",
      "ë¬˜",
      "ì ˆ",
      "íƒœ",
      "ì–‘"
    ],
    "ten_gods": [
      "ì‹­ì„±",
      "ì‹­ì‹ ",
      "ë¹„ê²¬",
      "ê²ì¬",
      "ì‹ì‹ ",
      "ìƒê´€",
      "í¸ì¬",
      "ì •ì¬",
      "í¸ê´€",
      "ì •ê´€",
      "í¸ì¸",
      "ì •ì¸"
    ],
    "five_elements": [
      "ì˜¤í–‰",
      "ëª©(",
      "í™”(",
      "í† (",
      "ê¸ˆ(",
      "ìˆ˜(",
      "ëª©(æœ¨)",
      "í™”(ç«)",
      "í† (åœŸ)",
      "ê¸ˆ(é‡‘)",
      "ìˆ˜(æ°´)"
    ],
    "ganji": [
      "ì²œê°„",
      "ì§€ì§€",
      "60ê°‘ì",
      "ìœ¡ì‹­ê°‘ì",
      "ì¼ì£¼",
      "ê°„ì§€"
    ]
  },
  "txt_doc_markers": [
    "^===== BEGIN .* =====$",
    "^BEGIN FILE: .*"
  ],
  "txt_heading_patterns": [
    "^#{1,6}\\s+",
    "^(I|II|III|IV|V|VI|VII|VIII|IX|X)\\.\\s+",
    "^\\d+(\\.\\d+)*\\.\\s+"
  ],
  "chunk_target_chars": [
    800,
    1200
  ],
  "logic_key_hash_len": 16
}
```
